# 서버 사이드 렌더링 
## 서버 사이드 렌더링이란 ? 
<p>웹 서비스의 초기 속도 로딩 속도 개선, 캐싱 및 검색 엔진 최적화를 가능하게 해 주는 기술입니다.
서버 사이드 렌더링을 사용하면 웹 서비스의 초기 렌더링을 사용자의 브라우저가 아닌 서버쪽에서 처리한다.

## 서버 사이드 렌더링의 장점

<p>❗️구글, 네이버, 다음 등의 검색 엔진이 우리가 만든 웹 애플리케이션의 페이지를 원활하게 수집할 수 있다.
<li>리액트로 만든 SPA는 검색 엔진 크롤러 봇처럼 자바스크립트가 실행되지 않는 환경에서 페이지가 제대로 나타나지 않는다.
<li>서버에서 클라이언트 대신 렌더링을 해 주면  검색 엔진이 페이지의 내용을 제대로 수집해 갈 수 있다.
<li>구글 검색 엔진은 다른 검색 엔진과 달리 검색 엔진에서 자바스크립ㅂ트를 시행하는 기능이 탑재되어 있으므로 제대로 페이지를 크롤링해 갈 때도 있지만,  모든 페이지에 대해 자바스크릡트를 실행해 주지는 않습니다.

<p> 따라서 웹 서비스의 검색 엔진 최적화를 위해서라면 서버 사이드 렌더링을 구현해 주는 것이 좋다
<br>
<p> ❗️서버 사이드 렌더링을 통해 초기 렌더링 성능을 개선할 수 있습니다.
<li>기존의 서버사이드 렌더링을 하지 않는 웹 페이지를 방문하면, 자바스크립트가 로딩되고 실행될떄 까지 사용자는 비어 있는 페이지를 보며 기다려야했다. 하지만 서버사이드 렌더링을 구현한 웹 페이지라면 자바스크립트 파일 다운로드가 완료되자 않는 시점에서도 html 상에 사용자가 볼 수 있는 콘텐츠가 있기 때문에 대기 시간이 최소화된다.

## 서버 사이드 렌더링의 단점

<li> 서버 사이드 렌더링은 결국 원래 브라우저가 해야 할일을 서버가 대신 처리하는 것으므로 서버 리소스가 사용된다.
<li>갑자기 수많은 사용자가 동시에 웹 페이지에 접속하면 서버에 과부하가 발생할 수 있다. 따라서, 사용자가 많은 서비스라면 캐싱과 로드 밸런싱을 통해 성능을 최적화 주어야 한다.
<li>서버 사이드 렌더링을 하면 프로젝트의 구조가 좀 더 복잡해 질수 있다.
<li>데이터 미리 불러오기, 코드 스플리팅과의 호환 등 고려해야 할 사항이 더 많아져서 개발이 어렵다.

## 서버사이드 렌더링 실습과정

<li>프로젝트 준비하기
<li>서버 사이드 렌더링 구현하기
<li>데이터  로딩하기
<li> 데이터 로딩하기


<hr>

### 프로젝트 준비하기

	yarn create reate-app ssr-recipe
	cd ssr-recipe
	yarn start


<p>서버 사이드 렌더링을 진행하기 전에 리액트 라우팅 해야하기 때문에 디렉터리에 react-router-dom 을 설치한다.
	yarn add react-router-dom

### 서버 사이드 렌더링 구현하기
<p>  ❗️서버 사이드 렌더링을 구현하려면 웹팩 설정을 커스터마이징해 주어야한다. CRA로 만든 프로젝트에서는 웹팩 관련 설정이 기본적을 모두 숨겨져 있으니 yarn eject 명령어를 실행하여 꺼내 주어야한다.

	$git init 
	$git add .
	$git commit -m 'Commit before eject'
	$yarn eject


#### 1. 서버 사이드 렌더링용 만들기
<li> 엔트리(entry)는 웹팩에서 프로젝트를 불러올 때 가장 불러오는 파일입니다.
<li> 서버사이드 렌더링을 할 때는 서버를 위한 엔트리 파일을 따로 생성해야한다.
<li> 예로 src 디렉터리에 index.server.js 라는 파일을 생성합니다.

	import ReactDomServer from 'react-dom/server'
	const html = ReactDomServer.renderToString(

	<div>Hello Server Side Rendering!</div>

	);
	console.log(html);

<p> ❗️서버에서 리액트 컴포넌트를 랜더링 할 때는 ReactDOMserver의 renderToString이라는 함수를  사용한다. 이함수에 JSX를 넣어서 호출하면 렌더링 결과를 문자열로 받을 수잇다.

#### 2. 서버 사이드 레더링 전용 웹팩 환경 설정 작성하기

<p> 작성한 엔트리 파일을 웹팩으로 불러와서 빌드하려면 서버 전용 환경 설정을 만들어주어야 한다.

<li>1. config 경로의 paths.js 파일을 열어 스크롤 아래 내린 후 module.export 부분에 두 줄을 추가해준다.

	ssrIndexJs : resolveApp('src/index.server.js'), //서버 사이드 렌더링
	ssrBuild : resolveApp('dist'), //웹팩 처리 후 저장 경로

<li>2. ssrIndexJs : 불러올 파일의 경로
<li>3. ssrBuild : 웹팩으로 처리한 뒤 결과물을 저장할 경로

##### 웹팩 환경 설정
<p>config 디렉터리에 webpack.confing.server.js 파일을 생성

	const paths = require('./paths')

	module.exports = {
	module : 'production', //프로덕션 모드로 설정하여 최적화 옵션들을 활성화
	entry : paths.ssrIndexJs, // 엔트리 경로
	target : 'node', //node 환경에서 실행될 것이라는 점을 명시
	output : {
		path : paths.ssrBuild, //빌드 경로
		filename : 'server.js' , //파일 이름
		chunkFilename : 'js/[name].chunk.js', //청크 파일 이름
		publicPath: paths.publicUrlOrPath, //정적 파일이 제공될 경로
		}
	};

<p> 웹팩 기본 설정을 작성했습니다. 어떤 파일에서 시작해 파일들을 불러오는지 , 또 어디에 결과물을 저장할지 를 정해 주었습니다. 

##### 로더 설정
<p> ❗️ 웹팩의 로더는 파일을 불러올 때 확장자에 맞게 필요한 처리를 해줍니다.
<p> 예로 들어 자바스크립트는 babel을 사용하여 트랜스파일링을 해 주고, CSS는 모든 CSS코드를 결합하 주고, 이미지 파일은 다른 경로에 따로 저장하고 그 파일에 대한 경로를 자바스크립트에서 참조 할 수있게 해줍니다.



